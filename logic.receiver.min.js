"use strict";var canvas=document.getElementById("game-canvas");canvas.height=window.innerHeight;canvas.width=window.innerWidth;var ctx=canvas.getContext("2d");var stars=[];var fps=50;var numStars=2e3;var pin=document.getElementById("pin");var pins;var laneDimensions={x1:canvas.width/3,x2:canvas.width-canvas.width/3};var ballPos;initGameCanvas();function initGameCanvas(){console.log("init gameCanvas");canvas.style.background="black";initStars();initPins();setInterval(animate,1e3/fps);ballPos={x:canvas.width/2,y:canvas.height/2};setTimeout(function(){deletePin(3);rollBall({x:canvas.width/2,y:canvas.height/3})},3e3)}function drawLane(){var grd=ctx.createLinearGradient(canvas.width/2,canvas.height,canvas.width/2,0);grd.addColorStop(0,"#985e22");grd.addColorStop(.8,"black");var points=[{x:0,y:canvas.height},{x:canvas.width/3,y:canvas.height/3},{x:canvas.width-canvas.width/3,y:canvas.height/3},{x:canvas.width,y:canvas.height}];drawPolygon(points,grd)}function drawPolygon(points,color){if(points.length>2){ctx.fillStyle=color;ctx.beginPath();ctx.moveTo(points[0].x,points[0].y);for(var item=1;item<points.length;item++){ctx.lineTo(points[item].x,points[item].y)}ctx.closePath();ctx.fill()}ctx.moveTo(points[0].x,points[0].y)}function Star(x,y,length,opacity){this.x=parseInt(x);this.y=parseInt(y);this.length=parseInt(length);this.opacity=opacity;this.factor=1;this.increment=Math.random()*.04}Star.prototype.draw=function(){ctx.rotate(Math.PI*1/10);ctx.save();ctx.translate(this.x,this.y);if(this.opacity>1){this.factor=-1}else if(this.opacity<=0){this.factor=1;this.x=Math.round(Math.random()*canvas.width);this.y=Math.round(Math.random()*canvas.height)}this.opacity+=this.increment*this.factor;ctx.beginPath();for(var i=5;i--;){ctx.lineTo(0,this.length);ctx.translate(0,this.length);ctx.rotate(Math.PI*2/10);ctx.lineTo(0,-this.length);ctx.translate(0,-this.length);ctx.rotate(-(Math.PI*6/10))}ctx.lineTo(0,this.length);ctx.closePath();ctx.fillStyle="rgba(255, 255, 200, "+this.opacity+")";ctx.shadowBlur=5;ctx.shadowColor="#ffff33";ctx.fill();ctx.restore()};function initStars(){for(var i=0;i<numStars;i++){var x=Math.round(Math.random()*canvas.width);var y=Math.round(Math.random()*canvas.height);var length=1+Math.random()*2;var opacity=Math.random();var star=new Star(x,y,length,opacity);stars.push(star)}}function drawPin(width,x,y){ctx.drawImage(pin,x-width/2,y,width,width*2)}function drawPins(){var scale=6;for(var i=pins.length-1;i>=0;i--){if(pins[i].standing){if(i<6){scale=5}if(i<3){scale=4}if(i<1){scale=3}drawPin(canvas.width/(5*scale),pins[i].x,pins[i].y)}}}function initPins(){var inc=(laneDimensions.x2-laneDimensions.x1)/7;var incY=inc/3;pins=[{standing:true,x:canvas.width/2,y:canvas.height/3},{standing:true,x:canvas.width/2-inc,y:canvas.height/3-incY},{standing:true,x:canvas.width/2+inc,y:canvas.height/3-incY},{standing:true,x:canvas.width/2-inc*2,y:canvas.height/3-incY*2},{standing:true,x:canvas.width/2,y:canvas.height/3-incY*2},{standing:true,x:canvas.width/2+inc*2,y:canvas.height/3-incY*2},{standing:true,x:canvas.width/2-inc*3,y:canvas.height/3-incY*3},{standing:true,x:canvas.width/2-inc,y:canvas.height/3-incY*3},{standing:true,x:canvas.width/2+inc,y:canvas.height/3-incY*3},{standing:true,x:canvas.width/2+inc*3,y:canvas.height/3-incY*3}]}function deletePin(pinNum){pins[pinNum].standing=false}function drawBall(position){if(position){console.log(position);ctx.beginPath();ctx.arc(position.x,position.y,50,0,2*Math.PI);ctx.fillStyle="red";ctx.fill();ballPos=position}else{ctx.beginPath();ctx.arc(ballPos.x,ballPos.y,50,0,2*Math.PI);ctx.fillStyle="green";ctx.fill()}}function rollBall(endLoc,speed){console.log("here");while(ballPos.y!=endLoc.y){ballPos.y--;animate()}}function animate(){ctx.clearRect(0,0,canvas.width,canvas.height);for(var star=0;star<stars.length;star++){stars[star].draw(ctx)}drawLane();drawPins();drawBall()}